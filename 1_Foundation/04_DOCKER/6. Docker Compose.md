# 🚀 Docker Compose – A Complete Guide

## 🔹 What is Docker Compose?
- A tool to manage **multi-container Docker applications**.
- Acts like an **orchestra conductor** 🎼: starts containers, connects them, and manages their dependencies.
- Instead of running multiple `docker run` commands, you declare everything in a **single YAML file** (`docker-compose.yml`).

---

## 🔹 When to Use Docker Compose?
Use it when your app requires:
- A **database** (PostgreSQL, MySQL, etc.)
- A **caching system** (Redis, Memcached)
- A **web server / backend service**
- A **frontend application**
  
Example: A web app with Flask + PostgreSQL + Redis.

---

## 🔹 Installing Docker Compose
- **Linux**: Install separately  
  ```bash
  sudo apt update
  sudo apt install docker-compose
  docker-compose --version
  ```
- Mac & Windows: Comes bundled with Docker Desktop.
- Official Guide → [Docker Compose Install Docs](https://docs.docker.com/compose/install/)

---
## 🔹 YAML Basics
- **YAML** = "YAML Ain’t Markup Language".
- Human-readable configuration format.
- Only structured data (not code).
- Example:
  ```yaml
  name: Raman
  skills:
    - Python
    - SQL
    - Power BI
    - Azure
    - Datacricks
    - Django
  ```
In Docker Compose, YAML is used to:
- Define services (containers).
- Set environment variables.
- Open ports.
- Configure volumes.

---

## 🔹 Sample docker-compose.yml
```yaml
  version: "3.8"
services:
  web:
    build: .
    ports:
      - "5000:5000"
    environment:
      - DATABASE_URL=postgres://user:pass@db:5432/mydb
      - REDIS_URL=redis://cache:6379
    volumes:
      - .:/app
    depends_on:
      - db
      - cache

  db:
    image: postgres:15
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: pass
      POSTGRES_DB: mydb
    volumes:
      - db-data:/var/lib/postgresql/data

  cache:
    image: redis:7

volumes:
  db-data:
```
---
## 🔹 Key Features in Docker Compose
1. Exposing Ports
```yaml
ports:
  - "5000:5000"
```
- Maps container’s port `5000` → local machine port `5000`.
- Access at: `http://localhost:5000`.

2. Mounting Local Filesystem
```yaml
volumes:
  - .:/app
```
- Mounts local project folder → container.
- Useful for live code updates in development.
- ⚠️ Not recommended in production.

3. Environment Variables
```yaml
environment:
  - DATABASE_URL=...
  - REDIS_URL=...
```
- Store configuration values like API keys & DB URLs.
- Can also use `.env` file for cleaner management.

4. Secrets & Credentials
- Development → use environment variables.
- Production → use Docker secrets.

5. Persistent Data with Volumes
```yaml
volumes:
  db-data:
```
- Prevents data loss when containers restart.
- Example: PostgreSQL database storage.

---
## 🔹 Running Docker Compose
- Start all services:
  ```bash
  docker-compose up
  ```
- Run in background (detached mode):
  ```bash
  docker-compose up -d
  ```
- Stop services:
  ```bash
  docker-compose down
  ```
- Rebuild containers:
  ```bash
  docker-compose build
  ```
---
## 🔹 Why Docker Compose Matters
✅ Run entire projects with one command.
✅ Define clean, reusable, version-controlled configs.
✅ Simulate production-like environments locally.
✅ Eliminate "works on my machine" issues.

---
## 🔹 Practice Tasks (Try It Yourself)
1. Spin Up a Flask App
- Run a basic Flask app on port `8000` using `python:3.11-slim`.

2. Add a Database
- Use PostgreSQL with a custom user, password, and database.
- Connect Flask app to PostgreSQL.

3. Mount Local Volume
- Mount project folder → container for live updates.

4. Use `.env` File
- Store credentials and DB URLs securely.

5. Persist Database Data
- Use Docker volumes for PostgreSQL persistence.

6. Expose Custom Port
- Run app on port `8080` instead of default.

7. Run in Detached Mode
- Start containers in background.

8. Check Logs
- Use `docker-compose logs` to debug containers.

